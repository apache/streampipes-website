"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[33244],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>c});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),p=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),d=p(a),g=n,c=d["".concat(s,".").concat(g)]||d[g]||u[g]||i;return a?r.createElement(c,o(o({ref:t},m),{},{components:a})):r.createElement(c,o({ref:t},m))}));function c(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=g;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:n,o[1]=l;for(var p=2;p<i;p++)o[p]=a[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}g.displayName="MDXCreateElement"},14619:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>m,contentTitle:()=>s,default:()=>c,frontMatter:()=>l,metadata:()=>p,toc:()=>d});var r=a(87462),n=a(63366),i=(a(67294),a(3905)),o=["components"],l={title:"Using Factory I/O with StreamPipes",author:"Sven Oehler"},s=void 0,p={permalink:"/blog/2022/09/05/using-factory.io-with-streampipes",source:"@site/blog/2022-09-05-using-factory.io-with-streampipes.md",title:"Using Factory I/O with StreamPipes",description:"10 minutes to read",date:"2022-09-05T00:00:00.000Z",formattedDate:"September 5, 2022",tags:[],readingTime:5.5,hasTruncateMarker:!0,authors:[{name:"Sven Oehler"}],frontMatter:{title:"Using Factory I/O with StreamPipes",author:"Sven Oehler"},prevItem:{title:"Apache StreamPipes release 0.70.0",permalink:"/blog/2022/10/13/release-070"},nextItem:{title:"Apache StreamPipes release 0.69.0",permalink:"/blog/2022/03/21/_release-0690"}},m={authorsImageUrls:[void 0]},d=[{value:"1. Factory I/O",id:"1-factory-io",level:2},{value:"2. Adapter",id:"2-adapter",level:2},{value:"3. Dashboard for raw data",id:"3-dashboard-for-raw-data",level:2},{value:"4. Creating a Data View",id:"4-creating-a-data-view",level:2},{value:"5. Modifying the Pipeline",id:"5-modifying-the-pipeline",level:2},{value:"6. Dashboard for preprocessed data",id:"6-dashboard-for-preprocessed-data",level:2},{value:"7. Final Data View",id:"7-final-data-view",level:2},{value:"Summary",id:"summary",level:2},{value:"CSV file for PLC tags",id:"csv-file-for-plc-tags",level:2}],u={toc:d},g="wrapper";function c(e){var t=e.components,a=(0,n.Z)(e,o);return(0,i.kt)(g,(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("div",{style:{float:"left",paddingRight:"40px"}},"10 minutes to read")),(0,i.kt)("br",null)),(0,i.kt)("p",null,'This tutorial shows how you can stream sensor data into StreamPipes from a simulation environment (Factory I/O). The\nsimulation environment is controlled by a "Siemens S7-1200" PLC and shows a conveyor belt which sorts packages by their\nheight. The tutorial is based on the upcoming version 0.70.0 and teaches you how to load the sensor data, build a\npipeline, preprocess the data and create visualizations.'),(0,i.kt)("img",{class:"blog-image",style:{maxWidth:"75%"},src:"/img/blog/2022-09-05/plc.jpg",alt:"plc"}),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"1-factory-io"},"1. Factory I/O"),(0,i.kt)("a",{href:"https://docs.factoryio.com/"},"*Factory* I/O")," is a 3D simulation for virtual factories and is commonly used as a PLC training platform. We will need it to simulate the live data.",(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Set up Factory I/O and make sure that the ",(0,i.kt)("a",{href:"https://docs.factoryio.com/tutorials/siemens/sample-s7-1200-1500/"},(0,i.kt)("em",{parentName:"li"},"Sorting by Height (Basic)"))," simulation works.")),(0,i.kt)("img",{className:"blog-image",style:{maxWidth:"90%"},src:"/img/blog/2022-09-05/factory.io.png",alt:"dataView"}),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"2-adapter"},"2. Adapter"),(0,i.kt)("p",null,"The next step is to connect the PLC to StreamPipes. To achieve this we need to create an adapter."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Start ",(0,i.kt)("a",{href:"https://streampipes.apache.org/docs/docs/user-guide-introduction.html"},(0,i.kt)("em",{parentName:"li"},"StreamPipes")),", go to the *\n*CONNECT",(0,i.kt)("strong",{parentName:"li"}," menu and create a "),"NEW ADAPTER**."),(0,i.kt)("li",{parentName:"ul"},"Select the ",(0,i.kt)("strong",{parentName:"li"},"PLC4X S7")," adapter, insert the ",(0,i.kt)("strong",{parentName:"li"},"IP-address")," of your PLC and ",(0,i.kt)("strong",{parentName:"li"},"import the file")," with the PLC tags (see\nbelow). Then click ",(0,i.kt)("strong",{parentName:"li"},"NEXT")," on the bottom right.")),(0,i.kt)("img",{className:"blog-image",style:{maxWidth:"90%"},src:"/img/blog/2022-09-05/adapter1.png",alt:"adapter1"}),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'If the warning "MISSING TIMESTAMP" appears, press ',(0,i.kt)("strong",{parentName:"li"},"ADD TIMESTAMP")," and then ",(0,i.kt)("strong",{parentName:"li"},"NEXT"),". This warning occurs because\nsome data sources don't provide a timestamp.")),(0,i.kt)("img",{className:"blog-image",style:{maxWidth:"90%"},src:"/img/blog/2022-09-05/adapter2.png",alt:"adapter2"}),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'You can name the adapter "S7_sorting" and select the option ',(0,i.kt)("strong",{parentName:"li"},"PERSIST EVENTS")," to make sure the data is persisted. The\nadapter is now ready to ",(0,i.kt)("strong",{parentName:"li"},"START"),". (You can check if the adapter is working by pressing the ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"?"))," symbol in the\nconnect menu and clicking on ",(0,i.kt)("strong",{parentName:"li"},"VALUES")," to see a live preview).")),(0,i.kt)("img",{className:"blog-image",style:{maxWidth:"90%"},src:"/img/blog/2022-09-05/adapter3.png",alt:"adapter3"}),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"3-dashboard-for-raw-data"},"3. Dashboard for raw data"),(0,i.kt)("p",null,"A dashboard is used to monitor live data from a data stream. We will use it to make sure that the sensor values are\nupdated when the simulation runs."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Go to the ",(0,i.kt)("strong",{parentName:"li"},"DASHBOARD")," menu and create a ",(0,i.kt)("strong",{parentName:"li"},"NEW DASHBOARD"),' "Dashboard_sorting". Press the pen symbol to edit the\ndashboard.'),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("strong",{parentName:"li"},"ADD VISUALIZATION"),' and select the automatically created pipeline "Persist S7_sorting". Choose the ',(0,i.kt)("strong",{parentName:"li"},"TABLE"),"\nwidget, configure it by pressing ",(0,i.kt)("strong",{parentName:"li"},"SELECT ALL")," and ",(0,i.kt)("strong",{parentName:"li"},"CREATE")," the widget."),(0,i.kt)("li",{parentName:"ul"},"Change the size of the table as you like and ",(0,i.kt)("strong",{parentName:"li"},"SAVE")," the dashboard."),(0,i.kt)("li",{parentName:"ul"},"The values should now update every 5 seconds. Test it by starting the simulation in Factory I/O.")),(0,i.kt)("img",{className:"blog-image",style:{maxWidth:"90%"},src:"/img/blog/2022-09-05/dashboard1.png",alt:"dashboard1"}),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"4-creating-a-data-view"},"4. Creating a Data View"),(0,i.kt)("p",null,"The Data View is used to create visualization for persisted data in a Data Lake. You can choose various visualization to\nexplore your data. We will create a table to see the stored data and a bar chart to take a closer look at a single\nsensor."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create a ",(0,i.kt)("strong",{parentName:"li"},"NEW DATA VIEW"),' "Sorting" in the ',(0,i.kt)("strong",{parentName:"li"},"DATA EXPLORER")," menu and edit the view."),(0,i.kt)("li",{parentName:"ul"},'Select the "Persist S7_sorting" pipeline at the ',(0,i.kt)("strong",{parentName:"li"},"NEW WIDGET")," menu, ",(0,i.kt)("strong",{parentName:"li"},"SELECT ALL")," fields and press ",(0,i.kt)("strong",{parentName:"li"},"NEXT"),"."),(0,i.kt)("li",{parentName:"ul"},"Select the ",(0,i.kt)("strong",{parentName:"li"},"TABLE")," visualization. Click ",(0,i.kt)("strong",{parentName:"li"},"SELECT ALL")," and ",(0,i.kt)("strong",{parentName:"li"},"CREATE"),".")),(0,i.kt)("img",{className:"blog-image",style:{maxWidth:"90%"},src:"/img/blog/2022-09-05/dataView1.png",alt:"dataView1"}),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Now we want to look closer at a single sensor value. Therefore click on the ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"+"))," symbol on the top left to add a\nnew widget."),(0,i.kt)("li",{parentName:"ul"},'Choose the "Persist S7_sorting" pipeline again, set the ',(0,i.kt)("strong",{parentName:"li"},"LIMIT")," to 1000 and only select the ",(0,i.kt)("strong",{parentName:"li"},"I_At_right_entry"),"\nfield. Now select  ",(0,i.kt)("strong",{parentName:"li"},"DISTRIBUTION")," as visualization and press ",(0,i.kt)("strong",{parentName:"li"},"CREATE"),". This chart shows how often the sensor\nreturned true or false (package in front of it or not).")),(0,i.kt)("img",{className:"blog-image",style:{maxWidth:"90%"},src:"/img/blog/2022-09-05/dataView2.png",alt:"dataView2"}),(0,i.kt)("h2",{id:"5-modifying-the-pipeline"},"5. Modifying the Pipeline"),(0,i.kt)("p",null,"The next step is to change the pipeline to add some preproccessing steps. We want to count the number of large packages\nwhich get transported to the right side and we want to measure the time between two arriving packages."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Therefore ",(0,i.kt)("strong",{parentName:"li"},"STOP"),' the running "Persist S7_sorting" pipeline in the ',(0,i.kt)("strong",{parentName:"li"},"PIPELINE")," menu and ",(0,i.kt)("strong",{parentName:"li"},"MODIFY")," the pipeline."),(0,i.kt)("li",{parentName:"ul"},"Add the ",(0,i.kt)("strong",{parentName:"li"},"BOOLEAN COUNTER")," as new pipeline element. Connect the data source to the counter and configure the element.\nSelect ",(0,i.kt)("strong",{parentName:"li"},"I_At_right_entry")," as boolean field and change the flank parameter to ",(0,i.kt)("strong",{parentName:"li"},"FALSE -> TRUE"),". Then add a ",(0,i.kt)("strong",{parentName:"li"},"DATA\nLAKE")," and connect the ",(0,i.kt)("strong",{parentName:"li"},"BOOLEAN COUNTER"),' to it. Use "Boolean_Counter" as identifier.'),(0,i.kt)("li",{parentName:"ul"},"Add the ",(0,i.kt)("strong",{parentName:"li"},"BOOLEAN TIMER")," to the pipeline and connect the data source to it. Select ",(0,i.kt)("strong",{parentName:"li"},"I_At_right_entry")," as boolean\nfield too and select ",(0,i.kt)("strong",{parentName:"li"},"TRUE")," and ",(0,i.kt)("strong",{parentName:"li"},"SECONDS")," in the configuration window. Add another ",(0,i.kt)("strong",{parentName:"li"},"DATA LAKE"),' and connect the *\n*BOOLEAN TIMER** to it. Use "Boolean_Timer" as identifier.'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"SAVE")," the pipeline and click the checkbox ",(0,i.kt)("strong",{parentName:"li"},"START PIPELINE IMMEDIATELY"),".")),(0,i.kt)("img",{className:"blog-image",style:{maxWidth:"90%"},src:"/img/blog/2022-09-05/pipeline.png",alt:"pipeline"}),(0,i.kt)("h2",{id:"6-dashboard-for-preprocessed-data"},"6. Dashboard for preprocessed data"),(0,i.kt)("p",null,"After we created two new data field in the last step, we will monitor them in the dashboard."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Go to the ",(0,i.kt)("strong",{parentName:"li"},"DASHBOARD")," menu and ",(0,i.kt)("strong",{parentName:"li"},"EDIT")," the dashboard."),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("strong",{parentName:"li"},"ADD VISUALIZATION"),' and select "Persist S7_sorting: Boolean_Counter". Create a ',(0,i.kt)("strong",{parentName:"li"},"TABLE")," widget as before and\n",(0,i.kt)("strong",{parentName:"li"},"SELECT ALL")," fields."),(0,i.kt)("li",{parentName:"ul"},'Now add one last table. Choose "Persist S7_sorting: Boolean_Timer" and only select the ',(0,i.kt)("strong",{parentName:"li"},"measured_time")," field"),(0,i.kt)("li",{parentName:"ul"},'Test your pipeline by starting the simulation again. The counter should now count up when a package passes the sensor\non the right side and the "measured_time" should show the time since the last package arrived.')),(0,i.kt)("img",{className:"blog-image",style:{maxWidth:"90%"},src:"/img/blog/2022-09-05/dashboard2.png",alt:"dashboard2"}),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"7-final-data-view"},"7. Final Data View"),(0,i.kt)("p",null,"Finally we want to improve the Data Explorer and create visualizations with the preprocessed data. We will create a time\nseries to verify when a new package arrived and a heat map to check the time between two packages."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Go to the ",(0,i.kt)("strong",{parentName:"li"},"DATA EXPLORER")," menu and edit the data view."),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("strong",{parentName:"li"},"ADD WIDGET"),' and choose the pipeline "Persist S7_sorting: Boolean_Counter". Select the ',(0,i.kt)("strong",{parentName:"li"},"counter")," field and\nchoose the ",(0,i.kt)("strong",{parentName:"li"},"TIME SERIES")," visualization."),(0,i.kt)("li",{parentName:"ul"},'Create another widget. Choose the "Persist S7_sorting: BooleanCounter" pipeline and select the ',(0,i.kt)("strong",{parentName:"li"},"measured_time"),"\nfield. Then select the ",(0,i.kt)("strong",{parentName:"li"},"HEATMAP"),' and use "measured_time" as ',(0,i.kt)("strong",{parentName:"li"},"HEAT VALUE"))),(0,i.kt)("img",{className:"blog-image",style:{maxWidth:"90%"},src:"/img/blog/2022-09-05/dataView3.png",alt:"dataView3"}),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"summary"},"Summary"),(0,i.kt)("p",null,"In this tutorial we learned how to connect a PLC to StreamPipes, monitor the data stream with a dashboard, create a\npipeline with different preprocessing steps and visualize the data in the Data View. But we just focused on the basics,\nso feel free to try out your own ideas and use different preprocessing steps, create new visualizations or try out\nanother simulation environment."),(0,i.kt)("h2",{id:"csv-file-for-plc-tags"},"CSV file for PLC tags"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"Runtime Name,Path,Data Type,Node Name,Comment,Hmi Visible,Hmi Accessible,Hmi Writeable,Typeobject ID,Version ID\nI_High_sensor,Tag table_1,Bool,%I0.0,,True,True,True,,\nI_Low_sensor,Tag table_1,Bool,%I0.1,,True,True,True,,\nI_Pallet_sensor,Tag table_1,Bool,%I0.2,,True,True,True,,\nI_Loaded,Tag table_1,Bool,%I0.3,,True,True,True,,\nI_At_left_entry,Tag table_1,Bool,%I0.4,,True,True,True,,\nI_At_left_exit,Tag table_1,Bool,%I0.5,,True,True,True,,\nI_At_right_entry,Tag table_1,Bool,%I0.6,,True,True,True,,\nI_At_right_exit,Tag table_1,Bool,%I0.7,,True,True,True,,\nO_Conveyor_entry,Tag table_1,Bool,%Q0.0,,True,True,True,,\nO_Load,Tag table_1,Bool,%Q0.1,,True,True,True,,\nO_Unload,Tag table_1,Bool,%Q0.2,,True,True,True,,\nO_Transf_left,Tag table_1,Bool,%Q0.3,,True,True,True,,\nO_Tranf_right,Tag table_1,Bool,%Q0.4,,True,True,True,,\nO_Conveyor_left,Tag table_1,Bool,%Q0.5,,True,True,True,,\n")))}c.isMDXComponent=!0}}]);