"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[45731],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var c=r.createContext({}),l=function(e){var t=r.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,c=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),u=l(a),m=n,h=u["".concat(c,".").concat(m)]||u[m]||d[m]||i;return a?r.createElement(h,s(s({ref:t},p),{},{components:a})):r.createElement(h,s({ref:t},p))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,s=new Array(i);s[0]=m;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o[u]="string"==typeof e?e:n,s[1]=o;for(var l=2;l<i;l++)s[l]=a[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},31690:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var r=a(87462),n=a(63366),i=(a(67294),a(3905)),s=["components"],o={id:"technicals-architecture",title:"Architecture",sidebar_label:"Architecture"},c=void 0,l={unversionedId:"technicals-architecture",id:"version-0.92.0/technicals-architecture",title:"Architecture",description:"Architecture",source:"@site/versioned_docs/version-0.92.0/07_technicals-architecture.md",sourceDirName:".",slug:"/technicals-architecture",permalink:"/docs/technicals-architecture",draft:!1,tags:[],version:"0.92.0",lastUpdatedBy:"Dominik Riemer",lastUpdatedAt:1698005176,formattedLastUpdatedAt:"Oct 22, 2023",sidebarPosition:7,frontMatter:{id:"technicals-architecture",title:"Architecture",sidebar_label:"Architecture"},sidebar:"documentation",previous:{title:"Migration Guide: 0.69.0",permalink:"/docs/extend-sdk-migration-service-discovery"},next:{title:"User Guidance",permalink:"/docs/technicals-user-guidance"}},p={},u=[{value:"Architecture",id:"architecture",level:2},{value:"StreamPipes Core",id:"streampipes-core",level:2},{value:"StreamPipes Extensions",id:"streampipes-extensions",level:2},{value:"StreamPipes Client",id:"streampipes-client",level:2},{value:"Third-party systems",id:"third-party-systems",level:2},{value:"Programming Languages",id:"programming-languages",level:2},{value:"Data Model",id:"data-model",level:2}],d={toc:u},m="wrapper";function h(e){var t=e.components,a=(0,n.Z)(e,s);return(0,i.kt)(m,(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"architecture"},"Architecture"),(0,i.kt)("img",{className:"docs-image",src:"/img/07_technicals/architecture.png",alt:"StreamPipes Architecture"}),(0,i.kt)("p",null,"Apache StreamPipes implements a microservice architecture as shown in the figure above."),(0,i.kt)("h2",{id:"streampipes-core"},"StreamPipes Core"),(0,i.kt)("p",null,"The StreamPipes Core is the central component to manage all StreamPipes resources.\nIt delegates the management of adapters, pipeline elements, pipelines and functions to registered extensions services (see below) and monitors the execution of extensions.\nThe Core also provides internal REST interfaces to communicate with the user interface, as well as public REST interfaces that can be used by external applications and StreamPipes clients."),(0,i.kt)("p",null,"Configuration and user data are stored in an Apache CouchDB database."),(0,i.kt)("h2",{id:"streampipes-extensions"},"StreamPipes Extensions"),(0,i.kt)("p",null,"An Apache StreamPipes extensions service is a microservice which contains the implementation of specific adapters, data streams, data processors, data sinks and functions.\nMultiple extension services can be part of a single StreamPipes installation.\nEach service might provide its own set of extensions. Extensions services register at the StreamPipes Core at startup. Users are able to install all or a subset of extensions of each service.\nThis allows StreamPipes to be extended at runtime by starting a new service with additional extensions."),(0,i.kt)("p",null,"Extensions can be built using the SDK (see ",(0,i.kt)("a",{parentName:"p",href:"/docs/extend-setup"},"Extending StreamPipes"),").\nExtensions services can be provided either in Java or in Python."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"As of version 0.93.0, the Python SDK supports functions only. If you would like to develop pipeline elements in Python as well, let us know in a ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/streampipes/discussions"},"Github discussions")," comment, so that we can better prioritize development.")),(0,i.kt)("p",null,"An extensions service interacts with the core by receiving control messages to invoke or detach an extension.\nIn addition, the core regularly fetches monitoring and log data from each registered extensions service."),(0,i.kt)("h2",{id:"streampipes-client"},"StreamPipes Client"),(0,i.kt)("p",null,"The Apache StreamPipes Client is a lightweight library for Java and Python which can be used to interact with StreamPipes resources programmatically.\nFor instance, users use the client to influence the control flow of pipelines, to download raw data from the data lake APIs or to realize custom applications with live data."),(0,i.kt)("h2",{id:"third-party-systems"},"Third-party systems"),(0,i.kt)("p",null,"In addition to the core components, an Apache StreamPipes version uses several third-party services, which are part of the standard installation."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Configurations and user data is stored in an ",(0,i.kt)("a",{parentName:"li",href:"https://couchdb.apache.org"},"Apache CouchDB")," database."),(0,i.kt)("li",{parentName:"ul"},"Time-series data is stored in an ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/influxdata/influxdb"},"InfluxDB")," database."),(0,i.kt)("li",{parentName:"ul"},"Events are exchanged over a messaging system. Users can choose from various messaging systems that StreamPipes supports. Currently, we support ",(0,i.kt)("a",{parentName:"li",href:"https://kafka.apache.org"},"Apache Kafka"),", ",(0,i.kt)("a",{parentName:"li",href:"https://pulsar.apache.org"},"Apache Pulsar"),", ",(0,i.kt)("a",{parentName:"li",href:"https://mqtt.org/"},"MQTT")," and ",(0,i.kt)("a",{parentName:"li",href:"https://nats.io/"},"NATS"),". The selection of the right messaging system depends on the use case. See ",(0,i.kt)("a",{parentName:"li",href:"/docs/technicals-messaging"},"Messaging")," for more information.")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Versions prior to 0.93.0 included Consul for service discovery and registration. Starting from 0.93.0 onwards, we switched to an internal service discovery mechanism.")),(0,i.kt)("p",null,"All mentioned third-party services are part of the default installation and are auto-configured during the installation process."),(0,i.kt)("h2",{id:"programming-languages"},"Programming Languages"),(0,i.kt)("p",null,"Apache StreamPipes is mainly written in Java.\nServices are based on Spring Boot.\nThe included ",(0,i.kt)("a",{parentName:"p",href:"https://streampipes.apache.org/docs/docs/python/latest/"},"Python integration")," is written in Python."),(0,i.kt)("p",null,"The user interface is mainly written in TypeScript using the Angular framework."),(0,i.kt)("h2",{id:"data-model"},"Data Model"),(0,i.kt)("p",null,"Internally, Apache StreamPipes realizes a stream processing layer where events are continuously exchanged over a messaging system.\nWhen building a pipeline, data processors consume data from a topic assigned by the core and publish data back to another topic, which is also assigned by the core."),(0,i.kt)("p",null,"At runtime, events have a flat and easily understandable data structure, consisting of key/value pairs. Events are serialized in JSON, although StreamPipes can be configured to use other (binary) message formats."),(0,i.kt)("p",null,"This allows for easy integration with other systems which want to consume data from Streampipes, since an event could look as simple as this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "timestamp": 1234556,\n  "deviceId": "ABC",\n  "temperature": 37.5\n}\n')),(0,i.kt)("p",null,"However, this wouldn't be very expressive, right? To ",(0,i.kt)("a",{parentName:"p",href:"/docs/technicals-user-guidance"},"assist users"),", StreamPipes provides a rich description layer for events. So under the hood, for the ",(0,i.kt)("inlineCode",{parentName:"p"},"temperature")," field shown above StreamPipes can also store the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "label": "Temperature",\n  "description": "Measures the temperature during leakage tests",\n  "measurementUnit": "https://qudt.org/vocab/unit/DEG_C",\n  "runtimeName": "temperature",\n  "runtimeType": "xsd:float",\n  "semanticType": "https://my-company-vocabulary/leakage-test-temperature"\n}\n')),(0,i.kt)("p",null,"By dividing the description layer from the runtime representation, we get a good trade-off between expressivity, readability for humans and lightweight runtime message formats.\nThe schema is stored in an internal schema registry and available to the client APIs and user interface views to improve validation and user guidance."),(0,i.kt)("p",null,"StreamPipes also supports arrays and nested structures, although we recommend using flat events where possible to ease integration with downstream systems (such as time-series storage)."))}h.isMDXComponent=!0}}]);